import{$ as A,T as E,V as N,W as T,X as O,Y as w,Z as j,aa as G,ba as P,ca as k,ea as B,fa as D,ga as R,ha as V,ia as z,ja as L,v as x,w as U}from"./chunk-2BWM5KPO.js";import{Ba as I,Ga as v,Ha as _,Ia as l,Ja as n,Ka as i,La as p,Mb as y,P as d,Pb as C,Ua as f,Wa as b,Wb as M,ac as S,hb as m,ja as c,jb as F,la as a,sa as g,wa as h}from"./chunk-OMC2ATSL.js";import{h as u}from"./chunk-7F6XFQYV.js";function q(o,e){if(o&1&&(n(0,"mat-option",13),m(1),i()),o&2){let t=e.$implicit;l("value",t.id),a(),F(" ",t.name," ")}}function H(o,e){if(o&1&&(n(0,"mat-form-field",7)(1,"mat-label"),m(2,"Team"),i(),n(3,"mat-select",11),I(4,q,2,2,"mat-option",12),i()()),o&2){let t=b();a(4),l("ngForOf",t.teams)}}var $=class o{constructor(e){this.fb=e}imagePath="assets/images/logo-piacenza-young.jpeg";router=d(M);auth=d(S);userInfoForm;userId="";teams=[];ngOnInit(){return u(this,null,function*(){this.userInfoForm=this.fb.group({full_name:[""],phone:[""],team:[""],isAdmin:[!1],isReader:[!1]}),this.loadTeams(),this.loadUserInfo()})}loadUserInfo(){return u(this,null,function*(){this.userId=yield this.auth.getCurrentUserId();let{data:e,error:t}=yield this.auth.getUserInfo(this.userId);this.userInfoForm.patchValue({full_name:e?.full_name,phone:e?.phone,team:e?.team,isAdmin:e?.admin,isReader:e?.reader})})}loadTeams(){return u(this,null,function*(){let{data:e,error:t}=yield this.auth.getTeams();t||(this.teams=e)})}onSubmit(){return u(this,null,function*(){let{error:e}=yield this.auth.updateUser(this.userId,this.userInfoForm.value.full_name,this.userInfoForm.value.phone,this.userInfoForm.value.team);e?alert("Error updating profile"):this.router.navigate(["/dashboard"])})}onCancel(){this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||o)(g(k))};static \u0275cmp=h({type:o,selectors:[["app-user-info"]],decls:20,vars:5,consts:[[1,"container"],[1,"d-flex","justify-content-center"],["alt","Logo",1,"logo","img-fluid",3,"src"],[1,"form-container",3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","full_name"],["matInput","","formControlName","phone","type","tel"],["appearance","outline","mandatory","true",1,"full-width"],[1,"justify-content-center","button-group"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["formControlName","team"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,r){if(t&1&&(n(0,"div",0)(1,"div",1),p(2,"img",2),i(),n(3,"h2",1),m(4,"Profilo Utente"),i(),n(5,"form",3),f("ngSubmit",function(){return r.onSubmit()}),n(6,"mat-form-field",4)(7,"mat-label"),m(8,"Nominativo"),i(),p(9,"input",5),i(),n(10,"mat-form-field",4)(11,"mat-label"),m(12,"Telefono"),i(),p(13,"input",6),i(),v(14,H,5,1,"mat-form-field",7),n(15,"div",8)(16,"button",9),f("click",function(){return r.onCancel()}),m(17," Annulla "),i(),n(18,"button",10),m(19," Conferma "),i()()()()),t&2){let s;a(2),l("src",r.imagePath,c),a(3),l("formGroup",r.userInfoForm),a(9),_(!((s=r.userInfoForm.get("isAdmin"))!=null&&s.value)&&!((s=r.userInfoForm.get("isReader"))!=null&&s.value)?14:-1),a(2),l("disabled",r.userInfoForm.invalid),a(2),l("disabled",r.userInfoForm.invalid)}},dependencies:[C,y,B,A,O,w,j,G,P,T,N,E,R,D,U,x,L,z,V],styles:[".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;max-width:400px;margin:0 auto;padding:24px;background-color:pink}.button-group[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:content-distributed;gap:12px}"]})};export{$ as UserInfo};
